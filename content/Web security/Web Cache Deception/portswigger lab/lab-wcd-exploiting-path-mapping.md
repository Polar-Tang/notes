https://portswigger.net/web-security/web-cache-deception/lab-wcd-exploiting-path-mapping

### Identify the origin delimiters
###### Find the not-idemponent header
- Look for HTTP request that are not stored in the cache, such as `cache-ontrol: private` 
- However you could use request with method not idempotents, in this case i use `R0` to compare with different request
- Test if the endpoint gives 404 in case of an nonexistent path
###### Bruteforce the delimiters
Use a [wordlist for delimiters](https://portswigger.net/web-security/web-cache-deception/wcd-lab-delimiter-list)
```sh
ffuf -u "https://0ad500ba04c3d40dd34c9ea100000043.web-security-academy.net/loginFUZZasd" -X POST -H "Content-Type: application/x-www-form-urlencoded" -w wordlist/delimiters.txt -d "csrf=bIA2hzcAlCfkQMGqgEsMj5bqiwTHa7t2&username=peter&password=wiener" -mc 400,403 -replay-proxy http:/127.0.0.1:8080
```
### Identify cache headers
Now identify a cacheable resource and append a random prefix after our wordlist delimiter
```sh
ffuf -u "https://0ad500ba04c3d40dd34c9ea100000043.web-security-academy.net/resources/labheader/js/labHeader.jsFUZZasd" -X GET -w wordlist/delimiters.txt -d "csrf=bIA2hzcAlCfkQMGqgEsMj5bqiwTHa7t2&username=peter&password=wiener" -mc "all" -fc 404 -replay-proxy http:/127.0.0.1:8080
```
### Indetify how the request is cached
In this case the delimeters are very typical, however some cache servers cached nased on the file extensions, so if we add some other extensions it gets cached
![[Pasted image 20250402002041.png]]
We could see here the cache oracle
